<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tidyrgeoda">
<title>Local Indicators of Spatial Association(LISA) • tidyrgeoda</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Local Indicators of Spatial Association(LISA)">
<meta property="og:description" content="tidyrgeoda">
<meta property="og:image" content="https://spatlyu.github.io/tidyrgeoda/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tidyrgeoda</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Local-Indicators-of-Spatial-Association.html">Local Indicators of Spatial Association(LISA)</a>
    <a class="dropdown-item" href="../articles/Spatial-Weights.html">Spatial Weights in tidyrgeoda</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/SpatLyu/tidyrgeoda/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Local Indicators of Spatial Association(LISA)</h1>
                        <h4 data-toc-skip class="author">Wenbo Lv</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SpatLyu/tidyrgeoda/blob/HEAD/vignettes/Local-Indicators-of-Spatial-Association.Rmd" class="external-link"><code>vignettes/Local-Indicators-of-Spatial-Association.Rmd</code></a></small>
      <div class="d-none name"><code>Local-Indicators-of-Spatial-Association.Rmd</code></div>
    </div>

    
    
<p><img src="../reference/figures/logo.png" align="right" height="175"></p>
<p><code>tidyrgeoda</code> provides following methods for local spatial
autocorrelation statistics by invoking <code>rgeoda</code>:</p>
<ul>
<li>Local Moran: <code><a href="../reference/st_local_moran.html">st_local_moran()</a></code>,
<code><a href="../reference/st_local_moran_eb.html">st_local_moran_eb()</a></code>, <code><a href="../reference/st_local_bimoran.html">st_local_bimoran()</a></code>
</li>
<li>Local Geary: <code><a href="../reference/st_local_geary.html">st_local_geary()</a></code>,
<code><a href="../reference/st_local_multigeary.html">st_local_multigeary()</a></code>
</li>
<li>Local Getis-Ord statistics: <code><a href="../reference/st_local_g.html">st_local_g()</a></code> and
<code><a href="../reference/st_local_gstar.html">st_local_gstar()</a></code>
</li>
<li>Local Join Count: <code><a href="../reference/st_local_joincount.html">st_local_joincount()</a></code>,
<code><a href="../reference/st_local_bijoincount.html">st_local_bijoincount()</a></code>,
<code><a href="../reference/st_local_multijoincount.html">st_local_multijoincount()</a></code>.</li>
<li>Quantile LISA: <code><a href="../reference/st_local_quantilelisa.html">st_local_quantilelisa()</a></code>,
<code><a href="../reference/st_local_multiquantilelisa.html">st_local_multiquantilelisa()</a></code>
</li>
<li>Local Neighbor Match Test: <code><a href="../reference/st_lnmt.html">st_lnmt()</a></code>
</li>
</ul>
<p>For more information about the local spatial autocorrelation
statisticis, please read Dr. Luc Anselin’s lab notes <a href="http://geodacenter.github.io/workbook/6a_local_auto/lab6a.html" class="external-link">here</a>.</p>
<p>This vignette references some content from <a href="https://spatialanalysis.github.io/handsonspatialdata/index.html" class="external-link">Hands-On
Spatial Data Science with R</a>.</p>
<div class="section level3">
<h3 id="load-data-and-package-">Load data and package.<a class="anchor" aria-label="anchor" href="#load-data-and-package-"></a>
</h3>
<p>We will use the <code>gzma</code> data in <code>tidyrgeoda</code>
package,more details to see <code><a href="../reference/gzma.html">?gzma</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/SpatLyu/tidyrgeoda" class="external-link">tidyrgeoda</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">gzma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gzma</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Simple feature collection with 6 features and 32 fields</span></span>
<span><span class="co">## Geometry type: POLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: 12605340 ymin: 2645065 xmax: 12614330 ymax: 2653022</span></span>
<span><span class="co">## Projected CRS: Popular Visualisation CRS / Mercator</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 33</span></span></span>
<span><span class="co">##   SName_EN       DName_EN SSQ_Score PS_Score EL_Score OH_Score IL_Score FPOP_Pro</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Datang Subdis… Yuexiu …      43.5     7.21     4.64     4.75     2.64    0.202</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Kuangquan Sub… Yuexiu …      29.3     3.55     3.81     3.91     4.06    0.716</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Dadong Subdis… Yuexiu …      51.2     7.94     4.69     4.86     3.31    0.215</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Donghu Subdis… Yuexiu …      57.0     8.22     4.93     4.92     3.74    0.178</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Baiyun Subdis… Yuexiu …      60.4     7.84     4.74     4.98     4.69    0.300</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> Huale Subdist… Yuexiu …      59.3     8.12     5.13     4.98     3.92    0.231</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 25 more variables: TenantsPro &lt;dbl&gt;, NoSchPro &lt;dbl&gt;, PSchPRO &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   JHSchPro &lt;dbl&gt;, HSchDipPro &lt;dbl&gt;, CDegreePro &lt;dbl&gt;, UnderG_Pro &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   PostG_Pro &lt;dbl&gt;, RPSOPMOPro &lt;dbl&gt;, PCE_Pro &lt;dbl&gt;, ProTechPro &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   ClerkPro &lt;dbl&gt;, BusSer_Pro &lt;dbl&gt;, AFAFP_Pro &lt;dbl&gt;, OPTE_Pro &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   UnemPeoPro &lt;dbl&gt;, B100_Pro &lt;dbl&gt;, `100_200Pro` &lt;dbl&gt;, `200_500Pro` &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   `500_1000P` &lt;dbl&gt;, `1000_1500P` &lt;dbl&gt;, `1500_2000P` &lt;dbl&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   `2000_3000P` &lt;dbl&gt;, A3000_Pro &lt;dbl&gt;, geometry &lt;POLYGON [m]&gt;</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="local-moran">Local Moran<a class="anchor" aria-label="anchor" href="#local-moran"></a>
</h3>
<p>The local Moran statistic was suggested in Anselin(1995) as a way to
identify local clusters and local spaital outliers. Most global spatial
autocorrelation can be expressed as a double sum over <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> indices, such as <span class="math inline">\(\sum_i\sum_j g_{ij}\)</span>.The local form of
such a statistic would then be, for each observation(location)<span class="math inline">\(i\)</span>, the sum of the relevant expression
over the <span class="math inline">\(j\)</span> index, <span class="math inline">\(\sum_j g_{ij}\)</span>.</p>
<p>Specifically, the local Moran statistic takes the form <span class="math inline">\(cz_i\sum_j \omega_{ij}z_j\)</span>, with <span class="math inline">\(z\)</span> in deviations from the mean. The scalar
c is the same for all locations and therefore does not play a role in
the assessment of significance. The latter is obtained by means of a
conditional permutation method, where, in turn, each <span class="math inline">\(z_i\)</span> is held fixed, and the remaining
z-values are randomly permuted to yield a reference distribution for the
statistic. This operates in the same fashion as for the global Moran’s
I, except that the permutation is carried out for each observation in
turn. The result is a pseudo p-value for each location, which can then
be used to assess significance. Note that this notion of significance is
not the standard one, and should not be interpreted that way (see the
discussion of multiple comparisons below).</p>
<p>Assessing significance in and of itself is not that useful for the
Local Moran. However, when an indication of significance is combined
with the location of each observation in the Moran Scatterplot, a very
powerful interpretation becomes possible. The combined information
allows for a classification of the significant locations as high-high
and low-low spatial clusters, and high-low and low-high spatial
outliers. It is important to keep in mind that the reference to high and
low is relative to the mean of the variable, and should not be
interpreted in an absolute sense.</p>
<p>Now,we use <code>SSQ_Score</code> in <code>gzma</code> data as an
example:</p>
<p><em>significance level at 0.05:</em></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gzma</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lisa <span class="op">=</span> <span class="fu"><a href="../reference/st_local_moran.html">st_local_moran</a></span><span class="op">(</span><span class="va">.</span>,<span class="st">'SSQ_Score'</span>,</span>
<span>                               wt <span class="op">=</span> <span class="fu"><a href="../reference/st_contiguity_weights.html">st_contiguity_weights</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>                               significance_cutoff <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lisa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">lisa</span><span class="op">)</span>,lwd <span class="op">=</span> <span class="fl">.1</span>,color <span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/scale_fill_lisa.html">scale_fill_lisa</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'LISA95'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Local-Indicators-of-Spatial-Association_files/figure-html/unnamed-chunk-2-1.png" width="900" style="display: block; margin: auto;"></p>
<p><em>significance level at 0.01:</em></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gzma</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lisa <span class="op">=</span> <span class="fu"><a href="../reference/st_local_moran.html">st_local_moran</a></span><span class="op">(</span><span class="va">.</span>,<span class="st">'SSQ_Score'</span>,</span>
<span>                               wt <span class="op">=</span> <span class="fu"><a href="../reference/st_contiguity_weights.html">st_contiguity_weights</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>                               significance_cutoff <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lisa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">lisa</span><span class="op">)</span>,lwd <span class="op">=</span> <span class="fl">.1</span>,color <span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/scale_fill_lisa.html">scale_fill_lisa</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'LISA99'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Local-Indicators-of-Spatial-Association_files/figure-html/unnamed-chunk-3-1.png" width="900" style="display: block; margin: auto;"></p>
<p><em>Bivariate Local Moran Statistics</em></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gzma</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lisa <span class="op">=</span> <span class="fu"><a href="../reference/st_local_bimoran.html">st_local_bimoran</a></span><span class="op">(</span><span class="va">.</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'OH_Score'</span>,<span class="st">'IL_Score'</span><span class="op">)</span>,</span>
<span>                               wt <span class="op">=</span> <span class="fu"><a href="../reference/st_contiguity_weights.html">st_contiguity_weights</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>                               significance_cutoff <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lisa</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">lisa</span><span class="op">)</span>,lwd <span class="op">=</span> <span class="fl">.1</span>,color <span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/scale_fill_lisa.html">scale_fill_lisa</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'bi-localmoran'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Local-Indicators-of-Spatial-Association_files/figure-html/unnamed-chunk-4-1.png" width="900" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="local-geary">Local Geary<a class="anchor" aria-label="anchor" href="#local-geary"></a>
</h3>
<p>The Local Geary statistic, first outlined in Anselin (1995), and
further elaborated upon in Anselin (2018), is a Local Indicator of
Spatial Association (LISA) that uses a different measure of attribute
similarity. As in its global counterpart, the focus is on squared
differences, or, rather, dissimilarity. In other words, small values of
the statistics suggest positive spatial autocorrelation, whereas large
values suggest negative spatial autocorrelation.</p>
<p>Formally, the Local Geary statistic is <span class="math inline">\(LG_i = \sum_j \omega_{ij} {(x_i - x_j)}^2\)</span>
in the usual notation.</p>
<p>Inference is again based on a conditional permutation procedure and
is interpreted in the same way as for the Local Moran statistic.
However, the interpretation of significant locations in terms of the
type of association is not as straightforward. In essence, this is
because the attribute similarity is not a cross-product and thus has no
direct correspondence with the slope in a scatter plot. Nevertheless, we
can use the linking capability within GeoDa to make an incomplete
classification.</p>
<p>Those locations identified as significant and with the Local Geary
statistic smaller than its mean, suggest positive spatial
autocorrelation (small differences imply similarity). For those
observations that can be classified in the upper-right or lower-left
quadrants of a matching Moran scatter plot, we can identify the
association as high-high or low-low. However, given that the squared
difference can cross the mean, there may be observations for which such
a classification is not possible. We will refer to those as other
positive spatial autocorrelation.</p>
<p>For negative spatial autocorrelation (large values imply
dissimilarity), it is not possible to assess whether the association is
between high-low or low-high outliers, since the squaring of the
differences removes the sign.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gzma</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lg <span class="op">=</span> <span class="fu"><a href="../reference/st_local_geary.html">st_local_geary</a></span><span class="op">(</span><span class="va">.</span>,<span class="st">'SSQ_Score'</span>,</span>
<span>                             wt <span class="op">=</span> <span class="fu"><a href="../reference/st_contiguity_weights.html">st_contiguity_weights</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>                             significance_cutoff <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">lg</span><span class="op">)</span>,lwd <span class="op">=</span> <span class="fl">.1</span>,color <span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/scale_fill_lisa.html">scale_fill_lisa</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'Local Geary'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Local-Indicators-of-Spatial-Association_files/figure-html/unnamed-chunk-5-1.png" width="900" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="local-getis-ord-statistics">Local Getis-Ord Statistics<a class="anchor" aria-label="anchor" href="#local-getis-ord-statistics"></a>
</h3>
<p>A third class of statistics for local spatial autocorrelation was
suggested by Getis and Ord (1992), and further elaborated upon in Ord
and Getis (1995). It is derived from a point pattern analysis logic. In
its earliest formulation the statistic consisted of a ratio of the
number of observations within a given range of a point to the total
count of points. In a more general form, the statistic is applied to the
values at neighboring locations (as defined by the spatial weights).
There are two versions of the statistic. They differ in that one takes
the value at the given location into account, and the other does
not.</p>
<p>The <span class="math inline">\(G_i\)</span> statistic consists of a
ratio of the weighted average of the values in the neighboring
locations, to the sum of all values, not including the value at the
location <span class="math inline">\(x_i\)</span>. <span class="math display">\[
G_i = \frac{\sum_{j\neq i}\omega_{ij}x_j}{\sum_{j\neq i}x_j}
\]</span></p>
<p>In contrast, the <span class="math inline">\(G_i^*\)</span> statistic
includes the value <span class="math inline">\(x_i\)</span> in numerator
and denominator: <span class="math display">\[
G_i^* = \frac{\sum_j\omega_{ij}x_j}{\sum_jx_j}
\]</span></p>
<p>Note that in this case, the denominator is constant across all
observations and simply consists of the total sum of all values in the
data set.</p>
<p>The interpretation of the Getis-Ord statistics is very
straightforward: a value larger than the mean (or, a positive value for
a standardized z-value) suggests a high-high cluster or hot spot, a
value smaller than the mean (or, negative for a z-value) indicates a
low-low cluster or cold spot. In contrast to the Local Moran and Local
Geary statistics, the Getis-Ord approach does not consider spatial
outliers.</p>
<p>Inference is based on conditional permutation, using an identical
procedure as for the other statistics.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gzma</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lg <span class="op">=</span> <span class="fu"><a href="../reference/st_local_g.html">st_local_g</a></span><span class="op">(</span><span class="va">.</span>,<span class="st">'SSQ_Score'</span>,</span>
<span>                             wt <span class="op">=</span> <span class="fu"><a href="../reference/st_contiguity_weights.html">st_contiguity_weights</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>                             significance_cutoff <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">lg</span><span class="op">)</span>,lwd <span class="op">=</span> <span class="fl">.1</span>,color <span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/scale_fill_lisa.html">scale_fill_lisa</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'Local G'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Local-Indicators-of-Spatial-Association_files/figure-html/unnamed-chunk-6-1.png" width="900" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gzma</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lg <span class="op">=</span> <span class="fu"><a href="../reference/st_local_gstar.html">st_local_gstar</a></span><span class="op">(</span><span class="va">.</span>,<span class="st">'SSQ_Score'</span>,</span>
<span>                             wt <span class="op">=</span> <span class="fu"><a href="../reference/st_contiguity_weights.html">st_contiguity_weights</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>                             significance_cutoff <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">lg</span><span class="op">)</span>,lwd <span class="op">=</span> <span class="fl">.1</span>,color <span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/scale_fill_lisa.html">scale_fill_lisa</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'Local Gstar'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Local-Indicators-of-Spatial-Association_files/figure-html/unnamed-chunk-7-1.png" width="900" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="local-join-count-statistic">Local Join Count Statistic<a class="anchor" aria-label="anchor" href="#local-join-count-statistic"></a>
</h3>
<p>Recently, Anselin and Li (2019) showed how a constrained version of
the <span class="math inline">\(G_i^*\)</span> statistic yields a local
version of the well-known join count statistic for spatial
autocorrelation of binary variables, popularized by Cliff and Ord
(1973). Expressed as a LISA statistic, a local version of the so-called
BB join count statistic is <span class="math display">\[
BB_i = x_i\sum_j\omega_{ij}x_j
\]</span></p>
<p>where <span class="math inline">\(x_{i,j}\)</span> can only take on
the values of 1 and 0, and <span class="math inline">\(\omega_{ij}\)</span> are the elements of a binary
spatial weights matrix (i.e., not row-standardized). For the most
meaningful results, the value of 1 should be chosen for the case with
the fewest observations (of course, the definition of what is 1 and 0
can easily be switched).</p>
<p>The statistic is only meaningful for those observations where <span class="math inline">\(x_i = 1\)</span>, since for <span class="math inline">\(x_i = 0\)</span> the result will always equal
zero. A pseudo p-value is obtained by means of a conditional permutation
approach, in the same way as for the other local spatial autocorrelation
statistics, but only for those observations with <span class="math inline">\(x_i = 1\)</span>. The same caveats as before
should be kept in mind when interpreting the results, which are subject
to multiple comparisons and the sensitivity of the pseudo p-value to the
actual simulation experiment (random seed, number of permutations).
Technical details are provided in Anselin and Li (2019).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gzma</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lg <span class="op">=</span> <span class="fu"><a href="../reference/st_local_joincount.html">st_local_joincount</a></span><span class="op">(</span><span class="va">.</span>,<span class="st">'SSQ_Score'</span>,</span>
<span>                                 wt <span class="op">=</span> <span class="fu"><a href="../reference/st_contiguity_weights.html">st_contiguity_weights</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>                                 significance_cutoff <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">lg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">lg</span><span class="op">)</span>,lwd <span class="op">=</span> <span class="fl">.1</span>,color <span class="op">=</span> <span class="st">'grey'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/scale_fill_lisa.html">scale_fill_lisa</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'Local Join Count'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="st">'cm'</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Local-Indicators-of-Spatial-Association_files/figure-html/unnamed-chunk-8-1.png" width="900" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://spatlyu.github.io/" class="external-link">Wenbo Lv</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
